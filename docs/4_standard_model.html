

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>4. The Standard Model &mdash; dustpy  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=92fd9be5" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="5. Dust Coagulation" href="5_dust_coagulation.html" />
    <link rel="prev" title="3. Advanced Customization" href="3_advanced_customization.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
              <img src="_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="1_basics.html">1. Basic usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_simple_customization.html">2. Simple Customization</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_advanced_customization.html">3. Advanced Customization</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">4. The Standard Model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Dust">Dust</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.dust.backreaction"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.backreaction</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.dust.boundary"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.boundary</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.dust.coagulation"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.coagulation</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.dust.delta"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.delta</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Simulation.dust.delta.rad"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.delta.rad</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Simulation.dust.delta.turb"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.delta.turb</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Simulation.dust.delta.vert"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.delta.vert</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.dust.Fi"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.Fi</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Simulation.dust.Fi.adv"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.Fi.adv</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Simulation.dust.Fi.diff"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.Fi.diff</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Simulation.dust.Fi.tot"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.Fi.tot</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.dust.p"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.p</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Simulation.dust.p.frag"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.p.frag</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Simulation.dust.p.stick"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.p.stick</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.dust.S"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.S</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Simulation.dust.S.coag"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.S.coag</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Simulation.dust.S.ext"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.S.ext</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Simulation.dust.S.hyd"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.S.hyd</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Simulation.dust.S.tot"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.S.tot</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.dust.v"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.v</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Simulation.dust.v.rel"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.v.rel</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Simulation.dust.v.driftmax"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.v.driftmax</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Simulation.dust.v.frag"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.v.frag</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Simulation.dust.v.rad"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.v.rad</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.dust.a"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.a</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.dust.D"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.D</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.dust.eps"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.eps</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.dust.fill"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.fill</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.dust.H"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.H</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.dust.kernel"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.kernel</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.dust.rho"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.rho</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.dust.rhos"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.rhos</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.dust.Sigma"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.Sigma</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.dust.SigmaFloor"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.SigmaFloor</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.dust.St"><code class="docutils literal notranslate"><span class="pre">Simulation.dust.St</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Update-order">Update order</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Gas">Gas</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.gas.boundary"><code class="docutils literal notranslate"><span class="pre">Simulation.gas.boundary</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.gas.S"><code class="docutils literal notranslate"><span class="pre">Simulation.gas.S</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Simulation.gas.S.ext"><code class="docutils literal notranslate"><span class="pre">Simulation.gas.S.ext</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Simulation.gas.S.hyd"><code class="docutils literal notranslate"><span class="pre">Simulation.gas.S.hyd</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Simulation.gas.S.tot"><code class="docutils literal notranslate"><span class="pre">Simulation.gas.S.tot</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.gas.torque"><code class="docutils literal notranslate"><span class="pre">Simulation.gas.torque</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Simulation.gas.torque.Lambda"><code class="docutils literal notranslate"><span class="pre">Simulation.gas.torque.Lambda</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Simulation.gas.torque.v"><code class="docutils literal notranslate"><span class="pre">Simulation.gas.torque.v</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.gas.v"><code class="docutils literal notranslate"><span class="pre">Simulation.gas.v</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Simulation.gas.v.rad"><code class="docutils literal notranslate"><span class="pre">Simulation.gas.v.rad</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Simulation.gas.v.visc"><code class="docutils literal notranslate"><span class="pre">Simulation.gas.v.visc</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.gas.alpha"><code class="docutils literal notranslate"><span class="pre">Simulation.gas.alpha</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.gas.cs"><code class="docutils literal notranslate"><span class="pre">Simulation.gas.cs</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.gas.eta"><code class="docutils literal notranslate"><span class="pre">Simulation.gas.eta</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.gas.Fi"><code class="docutils literal notranslate"><span class="pre">Simulation.gas.Fi</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.gas.Hp"><code class="docutils literal notranslate"><span class="pre">Simulation.gas.Hp</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.gas.mfp"><code class="docutils literal notranslate"><span class="pre">Simulation.gas.mfp</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.gas.mu"><code class="docutils literal notranslate"><span class="pre">Simulation.gas.mu</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.gas.n"><code class="docutils literal notranslate"><span class="pre">Simulation.gas.n</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.gas.nu"><code class="docutils literal notranslate"><span class="pre">Simulation.gas.nu</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.gas.P"><code class="docutils literal notranslate"><span class="pre">Simulation.gas.P</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.gas.rho"><code class="docutils literal notranslate"><span class="pre">Simulation.gas.rho</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.gas.Sigma"><code class="docutils literal notranslate"><span class="pre">Simulation.gas.Sigma</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.gas.SigmaFloor"><code class="docutils literal notranslate"><span class="pre">Simulation.gas.SigmaFloor</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.gas.T"><code class="docutils literal notranslate"><span class="pre">Simulation.gas.T</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#id1">Update order</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Grid">Grid</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.grid.A"><code class="docutils literal notranslate"><span class="pre">Simulation.grid.A</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.grid.m"><code class="docutils literal notranslate"><span class="pre">Simulation.grid.m</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.grid.Nm"><code class="docutils literal notranslate"><span class="pre">Simulation.grid.Nm</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.grid.Nr"><code class="docutils literal notranslate"><span class="pre">Simulation.grid.Nr</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.grid.OmegaK"><code class="docutils literal notranslate"><span class="pre">Simulation.grid.OmegaK</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.grid.r"><code class="docutils literal notranslate"><span class="pre">Simulation.grid.r</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.grid.ri"><code class="docutils literal notranslate"><span class="pre">Simulation.grid.ri</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Update order</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Star">Star</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.star.L"><code class="docutils literal notranslate"><span class="pre">Simulation.star.L</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.star.M"><code class="docutils literal notranslate"><span class="pre">Simulation.star.M</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.star.R"><code class="docutils literal notranslate"><span class="pre">Simulation.star.R</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation.star.T"><code class="docutils literal notranslate"><span class="pre">Simulation.star.T</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">Update order</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Time">Time</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Integrator">Integrator</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Writer">Writer</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="5_dust_coagulation.html">5. Dust Coagulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_dust_evolution.html">6. Dust Evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="7_gas_evolution.html">7. Gas Evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="dustpylib.html">Library: dustpylib</a></li>
<li class="toctree-l1"><a class="reference internal" href="test_analytical_coagulation_kernels.html">Test: Analytical Coagulation Kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="test_gas_evolution.html">Test: Gas Evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_ice_lines.html">Example: Ice Lines</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_planetary_gaps.html">Example: Planetary Gaps</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_planetesimal_formation.html">Example: Planetesimal Formation</a></li>
<li class="toctree-l1"><a class="reference internal" href="A_citation.html">Appendix A: Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="B_publications.html">Appendix B: List of Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="C_contrib_bug_feature.html">Appendix C: Contributing/Bugs/Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="D_discussions.html">Appendix D: DustPy Discussions</a></li>
<li class="toctree-l1"><a class="reference internal" href="E_changelog.html">Appendix E: Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">Module Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">dustpy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">4. The Standard Model</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/4_standard_model.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p><a class="reference external" href="https://mybinder.org/v2/gh/stammler/dustpy/HEAD?labpath=examples%2F4_standard_model.ipynb"><img alt="Binder" src="https://mybinder.org/badge_logo.svg" /></a></p>
<section id="4.-The-Standard-Model">
<h1>4. The Standard Model<a class="headerlink" href="#4.-The-Standard-Model" title="Link to this heading"></a></h1>
<p>In this chapter we’ll go through all fields in the standard model, explain their meaning and the default functions that calculate them.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dustpy</span> <span class="kn">import</span> <span class="n">Simulation</span>
<span class="kn">from</span> <span class="nn">dustpy</span> <span class="kn">import</span> <span class="n">constants</span> <span class="k">as</span> <span class="n">c</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">Simulation</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>By default the frame object of <code class="docutils literal notranslate"><span class="pre">DustPy</span></code> consists of four groups for <strong>dust</strong>, <strong>gas</strong>, <strong>grid</strong>, and <strong>stellar</strong> parameters, a field for the <strong>time</strong>, which is the integration variable, an <strong>integrator</strong> object, and a <strong>writer</strong> object.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DustPy
------
    dust         : Group (Dust quantities)
    gas          : Group (Gas quantities)
    grid         : Group (Grid quantities)
    star         : Group (Stellar quantities)
  -----
    t            : IntVar (Time [s]), <span class="ansi-magenta-intense-fg">Integration variable</span>
  -----
    Integrator   : Integrator (Default integrator)
    Writer       : Writer (HDF5 file format using h5py)
</pre></div></div>
</div>
<section id="Dust">
<h2>Dust<a class="headerlink" href="#Dust" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Group (Dust quantities)
-----------------------
    backreaction : Group (Backreaction coefficients)
    boundary     : Group (Boundary conditions)
    coagulation  : Group (Coagulation quantities)
    delta        : Group (Mixing parameters)
    Fi           : Group (Fluxes)
    p            : Group (Probabilities)
    S            : Group (Sources)
    v            : Group (Velocities)
  -----
    a            : Field (Particle size [cm])
    D            : Field (Diffusivity [cm²/s])
    eps          : Field (Dust-to-gas ratio)
    fill         : Field (Filling factor)
    H            : Field (Scale heights [cm])
    kernel       : Field (Collision kernel [cm²/s])
    rho          : Field (Midplane mass density per mass bin [g/cm³])
    rhos         : Field (Solid state density [g/cm³])
    Sigma        : Field (Surface density per mass bin [g/cm²])
    SigmaFloor   : Field (Floor value of surface density [g/cm²])
    St           : Field (Stokes number)
  -----
</pre></div></div>
</div>
<section id="Simulation.dust.backreaction">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.dust.backreaction</span></code><a class="headerlink" href="#Simulation.dust.backreaction" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">backreaction</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Group (Backreaction coefficients)
---------------------------------
    A            : Field (Pull factor)
    B            : Field (Push factor)
  -----
</pre></div></div>
</div>
<p>The backreaction describes the hydrodynamic influence the dust has on the gas. Numerically it consists of two fields <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> of shape <code class="docutils literal notranslate"><span class="pre">(Simulation.grid.Nr,)</span></code> that describe the pull respectively the push the dust excerts on the gas.</p>
<p>The details of this mechanism are described in <a class="reference external" href="https://doi.org/10.3847/1538-4357/aaf4fc">Gárate et al. (2019)</a>.</p>
<p>Backreaction modifies the radial gas velocity as follows</p>
<p><span class="math notranslate nohighlight">\(\Large v_\mathrm{g} = Av_\mathrm{visc} + 2B\eta v_\mathrm{K}\)</span>.</p>
<p>In the standard model we have <code class="docutils literal notranslate"><span class="pre">A=1</span></code> and <code class="docutils literal notranslate"><span class="pre">B=0</span></code> everywhere, i.e., backreactions is not active.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">backreaction</span><span class="o">.</span><span class="n">A</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
 1. 1. 1. 1.]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">backreaction</span><span class="o">.</span><span class="n">B</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0.]
</pre></div></div>
</div>
<p>Depending on the type of backreaction that you want to model, you have to provide functions for <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code>. Have a look at Appendix A of <a class="reference external" href="https://doi.org/10.3847/1538-4357/aaf4fc">Gárate et al. (2019)</a> for examples.</p>
</section>
<section id="Simulation.dust.boundary">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.dust.boundary</span></code><a class="headerlink" href="#Simulation.dust.boundary" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">boundary</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Group (Boundary conditions)
---------------------------
    inner        : Boundary
    outer        : Boundary
  -----
</pre></div></div>
</div>
<p>By default the inner dust boundary is set to constant gradient and the outer boundary to floor value.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">inner</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Constant gradient
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">outer</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Value
</pre></div></div>
</div>
<p>The outer boundary therefore stores an array with the floor values of all particle masses.</p>
<p>The boundary conditions can be changed via <code class="docutils literal notranslate"><span class="pre">setcondition()</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">outer</span><span class="o">.</span><span class="n">setcondition</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on method setcondition in module dustpy.utils.boundary:

setcondition(condition, value=None) method of dustpy.utils.boundary.Boundary instance
    Function to set boundary condition.

    Parameters
    ----------
    condition : string
        Type of boundary conditon:
            - &#34;const_grad&#34; : constant gradient
            - &#34;const_pow&#34; : constant power law
            - &#34;const_val&#34; : constant value
            - &#34;val&#34; : custom value
            - &#34;grad&#34; : custom gradient
            - &#34;pow&#34; : custom power law with set exponent
            - None : Don&#39;t impose boundary condition (default)
    value : float or array, optional, default : None
        Value if needed for boundary condition

</pre></div></div>
</div>
</section>
<section id="Simulation.dust.coagulation">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.dust.coagulation</span></code><a class="headerlink" href="#Simulation.dust.coagulation" title="Link to this heading"></a></h3>
<p>The fields in this group define the behavior of dust growth and are discussed in a separate chapter about dust coagulation.</p>
</section>
<section id="Simulation.dust.delta">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.dust.delta</span></code><a class="headerlink" href="#Simulation.dust.delta" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">delta</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Group (Mixing parameters)
-------------------------
    rad          : Field (Radial mixing parameter)
    turb         : Field (Turbulent mixing parameter)
    vert         : Field (Vertical mixing parameter)
  -----
</pre></div></div>
</div>
<p>The <span class="math notranslate nohighlight">\(\large \delta\)</span> parameters control the mixing of dust particles along vertical and radial directions and turbulent mixing. You can look at them as similar to the turbulent <span class="math notranslate nohighlight">\(\large \alpha\)</span> parameter for the gas. And by default they will have the same value as <span class="math notranslate nohighlight">\(\large \alpha\)</span> as given by <code class="docutils literal notranslate"><span class="pre">Simulation.ini.gas.alpha</span></code>.</p>
<section id="Simulation.dust.delta.rad">
<h4><code class="docutils literal notranslate"><span class="pre">Simulation.dust.delta.rad</span></code><a class="headerlink" href="#Simulation.dust.delta.rad" title="Link to this heading"></a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">delta</span><span class="o">.</span><span class="n">rad</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001]
</pre></div></div>
</div>
<p><span class="math notranslate nohighlight">\(\large \delta_\mathrm{rad}\)</span> will be used to calculate the radial dust diffusion.</p>
</section>
<section id="Simulation.dust.delta.turb">
<h4><code class="docutils literal notranslate"><span class="pre">Simulation.dust.delta.turb</span></code><a class="headerlink" href="#Simulation.dust.delta.turb" title="Link to this heading"></a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">delta</span><span class="o">.</span><span class="n">turb</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001]
</pre></div></div>
</div>
<p><span class="math notranslate nohighlight">\(\large \delta_\mathrm{turb}\)</span> will be used to calculate the turbulent collision velocities of the dust particles.</p>
</section>
<section id="Simulation.dust.delta.vert">
<h4><code class="docutils literal notranslate"><span class="pre">Simulation.dust.delta.vert</span></code><a class="headerlink" href="#Simulation.dust.delta.vert" title="Link to this heading"></a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">delta</span><span class="o">.</span><span class="n">vert</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001]
</pre></div></div>
</div>
<p><span class="math notranslate nohighlight">\(\large \delta_\mathrm{vert}\)</span> will be used to calculate the vertical dust scale heights.</p>
</section>
</section>
<section id="Simulation.dust.Fi">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.dust.Fi</span></code><a class="headerlink" href="#Simulation.dust.Fi" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">Fi</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Group (Fluxes)
--------------
    adv          : Field (Advective flux [g/cm/s])
    diff         : Field (Diffusive flux [g/cm/s])
    tot          : Field (Total flux [g/cm/s])
  -----
</pre></div></div>
</div>
<p>This is a group of fluxes through the radial grid interfaces for every particle mass of shape <code class="docutils literal notranslate"><span class="pre">(Simulation.grid.Nr+1,,</span> <span class="pre">Simulation.grid.Nm)</span></code>.</p>
<p><strong>Attention:</strong> When using implicit dust integration, the interface fluxes are calculated in retrospect after the new dust surface density was found. Changing any <code class="docutils literal notranslate"><span class="pre">Simulation.dust.Fi</span></code> does not influence the simulation. It is only given for data analysis.</p>
<section id="Simulation.dust.Fi.adv">
<h4><code class="docutils literal notranslate"><span class="pre">Simulation.dust.Fi.adv</span></code><a class="headerlink" href="#Simulation.dust.Fi.adv" title="Link to this heading"></a></h4>
<p>This is the advective flux calculated by <span class="math notranslate nohighlight">\(\large F_\mathrm{adv} = v_\mathrm{d}\Sigma_\mathrm{d}\)</span>.</p>
<p><strong>Attention:</strong> When using implicit dust integration, the advective interface fluxes are calculated in retrospect after the new dust surface density was found. Changing <code class="docutils literal notranslate"><span class="pre">Simulation.dust.Fi.adv</span></code> does not influence the simulation. It is only given for data analysis.</p>
</section>
<section id="Simulation.dust.Fi.diff">
<h4><code class="docutils literal notranslate"><span class="pre">Simulation.dust.Fi.diff</span></code><a class="headerlink" href="#Simulation.dust.Fi.diff" title="Link to this heading"></a></h4>
<p>This is the diffusive flux calculated by <span class="math notranslate nohighlight">\(\large F_\mathrm{diff} = -D\Sigma_\mathrm{g}\nabla\frac{\Sigma_\mathrm{d}}{\Sigma_\mathrm{gas}}\)</span> for every particle species separately. The diffusive fluxes at the grid boundaries are set to zero to avoid instabilities.</p>
<p><strong>Attention:</strong> When using implicit dust integration, the diffusive interface fluxes are calculated in retrospect after the new dust surface density was found. Changing <code class="docutils literal notranslate"><span class="pre">Simulation.dust.Fi.diff</span></code> does not influence the simulation. It is only given for data analysis.</p>
</section>
<section id="Simulation.dust.Fi.tot">
<h4><code class="docutils literal notranslate"><span class="pre">Simulation.dust.Fi.tot</span></code><a class="headerlink" href="#Simulation.dust.Fi.tot" title="Link to this heading"></a></h4>
<p>This is the total flux through the radial grid interfaces <span class="math notranslate nohighlight">\(\large F_\mathrm{tot} = F_\mathrm{adv} + F_\mathrm{diff}\)</span>.</p>
<p><strong>Attention:</strong> When using implicit dust integration, the total interface fluxes are calculated in retrospect after the new dust surface density was found. Changing <code class="docutils literal notranslate"><span class="pre">Simulation.dust.Fi.tot</span></code> does not influence the simulation. It is only given for data analysis.</p>
</section>
</section>
<section id="Simulation.dust.p">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.dust.p</span></code><a class="headerlink" href="#Simulation.dust.p" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">p</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Group (Probabilities)
---------------------
    frag         : Field (Fragmentation probability)
    stick        : Field (Sticking probability)
  -----
</pre></div></div>
</div>
<div class="line-block">
<div class="line">These are the fragmentation and sticking probability of certain particle collisions.</div>
<div class="line">Their shape is <code class="docutils literal notranslate"><span class="pre">(Simulation.grid.Nr,</span> <span class="pre">Simulation.grid.Nm,</span> <span class="pre">Simulation.grid.Nm)</span></code>.</div>
</div>
<p>The fragmentation probability of particle <code class="docutils literal notranslate"><span class="pre">i=80</span></code>, with particle <code class="docutils literal notranslate"><span class="pre">j=3</span></code> at radial grid cell <code class="docutils literal notranslate"><span class="pre">ir=30</span></code> is given by</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ir</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">80</span>
<span class="n">j</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">frag</span><span class="p">[</span><span class="n">ir</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
np.float64(0.9911366648697515)
</pre></div></div>
</div>
<section id="Simulation.dust.p.frag">
<h4><code class="docutils literal notranslate"><span class="pre">Simulation.dust.p.frag</span></code><a class="headerlink" href="#Simulation.dust.p.frag" title="Link to this heading"></a></h4>
<p><code class="docutils literal notranslate"><span class="pre">DustPy</span></code> assumes that the relative collision velocities follow the Maxwell-Boltzmann distribution</p>
<p><span class="math notranslate nohighlight">\(\Large f\left(\Delta v\right) = \sqrt{\frac{54}{\pi}}\frac{\Delta v^{2}}{v_\mathrm{rms}^3} \exp \left[-\frac{3}{2} \frac{\Delta v^2}{v_\mathrm{rms}^2} \right]\)</span>.</p>
<p>The collision kernel for fragmentation is then given by</p>
<p><span class="math notranslate nohighlight">\(\Large K_\mathrm{f} = \int\limits_{v_\mathrm{frag}}^\infty \sigma_\mathrm{geo} \Delta v f\left(\Delta v\right) \mathrm{d}\Delta v\)</span></p>
<p>by counting all collisions above the fragmentation velocity.</p>
<p>The fragmentation probability is the given by</p>
<p><span class="math notranslate nohighlight">\(\Large p_\mathrm{f} = \frac{K_\mathrm{f}}{\sigma_\mathrm{geo} \Delta \bar{v}}\)</span></p>
<p>with the mean velocity of the Maxwell-Boltzmann distribution</p>
<p><span class="math notranslate nohighlight">\(\Large \Delta \bar{v} = \sqrt{\frac{8\pi}{2}}v_\mathrm{rms}\)</span>.</p>
<p>The root-mean-square velocities <span class="math notranslate nohighlight">\(\large v_\mathrm{rms}\)</span> are stored in <code class="docutils literal notranslate"><span class="pre">Simulation.dust.v.rel</span></code>.</p>
</section>
<section id="Simulation.dust.p.stick">
<h4><code class="docutils literal notranslate"><span class="pre">Simulation.dust.p.stick</span></code><a class="headerlink" href="#Simulation.dust.p.stick" title="Link to this heading"></a></h4>
<p>This is the sticking probability given by <span class="math notranslate nohighlight">\(\large p_\mathrm{s} = 1 - p_\mathrm{f}\)</span>.</p>
<p>Bouncing can be easily implemented if <span class="math notranslate nohighlight">\(\large 0 \leq p_\mathrm{f} + p_\mathrm{s} &lt; 1\)</span>.</p>
</section>
</section>
<section id="Simulation.dust.S">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.dust.S</span></code><a class="headerlink" href="#Simulation.dust.S" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">S</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Group (Sources)
---------------
    coag         : Field (Coagulation sources [g/cm²/s])
    ext          : Field (External sources [g/cm²/s])
    hyd          : Field (Hydrodynamic sources [g/cm²/s])
    tot          : Field (Tot sources [g/cm²/s])
  -----
</pre></div></div>
</div>
<p>These are the source terms of the dust of shape <code class="docutils literal notranslate"><span class="pre">(Simulation.grid.Nr,</span> <span class="pre">Simulation.grid.Nm)</span></code> used to integrate the time evolution of the dust.</p>
<section id="Simulation.dust.S.coag">
<h4><code class="docutils literal notranslate"><span class="pre">Simulation.dust.S.coag</span></code><a class="headerlink" href="#Simulation.dust.S.coag" title="Link to this heading"></a></h4>
<p>The source terms from dust coagulation. This is described in detail in a separate chapter about dust coagulation.</p>
<p><strong>Attention:</strong> When using implicit dust integration, the coagulation source terms are calculated in retrospect after the new dust surface density was found. Changing <code class="docutils literal notranslate"><span class="pre">Simulation.dust.S.coag</span></code> does not influence the simulation. It is only given for data analysis.</p>
</section>
<section id="Simulation.dust.S.ext">
<h4><code class="docutils literal notranslate"><span class="pre">Simulation.dust.S.ext</span></code><a class="headerlink" href="#Simulation.dust.S.ext" title="Link to this heading"></a></h4>
<p>External source terms. These are by default set to zero, i.e. no external sources.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">ext</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
</pre></div></div>
</div>
</section>
<section id="Simulation.dust.S.hyd">
<h4><code class="docutils literal notranslate"><span class="pre">Simulation.dust.S.hyd</span></code><a class="headerlink" href="#Simulation.dust.S.hyd" title="Link to this heading"></a></h4>
<p>These are the hydrodynamic source terms. At grid cell <span class="math notranslate nohighlight">\(i\)</span> they are calculated by</p>
<p><span class="math notranslate nohighlight">\(\Large S_{\mathrm{hyd},\,i} = 2\frac{\left( r_{i-\frac{1}{2}}F_{i-\frac{1}{2}}-r_{i+\frac{1}{2}}F_{i+\frac{1}{2}} \right)}{r_{i+\frac{1}{2}}^2 - r_{i-\frac{1}{2}}^2}\)</span>.</p>
<p><strong>Attention:</strong> When using implicit dust integration, the hydrodynamic source terms are calculated in retrospect after the new dust surface density was found. Changing <code class="docutils literal notranslate"><span class="pre">Simulation.dust.S.hyd</span></code> does not influence the simulation. It is only given for data analysis.</p>
</section>
<section id="Simulation.dust.S.tot">
<h4><code class="docutils literal notranslate"><span class="pre">Simulation.dust.S.tot</span></code><a class="headerlink" href="#Simulation.dust.S.tot" title="Link to this heading"></a></h4>
<p>These are the total source terms given by <span class="math notranslate nohighlight">\(\large S_\mathrm{tot} = S_\mathrm{coag} + S_\mathrm{ext} + S_\mathrm{hyd}\)</span>.</p>
</section>
</section>
<section id="Simulation.dust.v">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.dust.v</span></code><a class="headerlink" href="#Simulation.dust.v" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">v</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Group (Velocities)
------------------
    rel          : Group (Relative velocities)
  -----
    driftmax     : Field (Maximum drift velocity [cm/s])
    frag         : Field (Fragmentation velocity [cm/s])
    rad          : Field (Radial velocity [cm/s])
  -----
</pre></div></div>
</div>
<p>These are some dust related velocities the simulation needs for execution.</p>
<section id="Simulation.dust.v.rel">
<h4><code class="docutils literal notranslate"><span class="pre">Simulation.dust.v.rel</span></code><a class="headerlink" href="#Simulation.dust.v.rel" title="Link to this heading"></a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">rel</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Group (Relative velocities)
---------------------------
    azi          : Field (Relative azimuthal velocity [cm/s])
    brown        : Field (Relative Brownian motion velocity [cm/s])
    rad          : Field (Relative radial velocity [cm/s])
    tot          : Field (Total relative velocity [cm/s])
    turb         : Field (Relative turbulent velocity [cm/s])
    vert         : Field (Relative vertical settling velocity [cm/s])
  -----
</pre></div></div>
</div>
<div class="line-block">
<div class="line">These are the different sources of relative particle collision velocities used by the coagulation algorithm.</div>
<div class="line">They are used for two different reasons:</div>
</div>
<ol class="arabic simple">
<li><p>To calculated the collision rates</p></li>
<li><p>To determine the outcome of a collision</p></li>
</ol>
<section id="Simulation.dust.v.rel.azi">
<h5><code class="docutils literal notranslate"><span class="pre">Simulation.dust.v.rel.azi</span></code><a class="headerlink" href="#Simulation.dust.v.rel.azi" title="Link to this heading"></a></h5>
<p>Relative collision velocity caused by a differential azimuthal drift of particles with different Stokes numbers calculated by</p>
<p><span class="math notranslate nohighlight">\(\Large v_{\mathrm{rel},\,\mathrm{azi}} = \left| v_{\mathrm{drift},\,\mathrm{max}} \cdot \left( \frac{1}{1+\mathrm{St}_i^2} - \frac{1}{1+\mathrm{St}_j^2} \right) \right|\)</span>.</p>
</section>
<section id="Simulation.dust.v.brown">
<h5><code class="docutils literal notranslate"><span class="pre">Simulation.dust.v.brown</span></code><a class="headerlink" href="#Simulation.dust.v.brown" title="Link to this heading"></a></h5>
<p>Relative collision velocity of particles caused by Brownian motion calculated with</p>
<p><span class="math notranslate nohighlight">\(\Large v_{\mathrm{rel},\,\mathrm{brown}} = \sqrt{ \frac{8k_\mathrm{B}T\left(m_i + m_j \right)}{\pi m_i m_j} }\)</span>.</p>
<p>Since this expression is diverging for very small particle masses, the relative velocity is capped to a maximum value of the sound speed <span class="math notranslate nohighlight">\(c_\mathrm{s}\)</span>. For very small particles this can still be larger than the fragmentation velocity and can cause unwanted fragmentation in the simple coagulation algorithm implemented in the default model.</p>
</section>
<section id="Simulation.dust.v.rel.rad">
<h5><code class="docutils literal notranslate"><span class="pre">Simulation.dust.v.rel.rad</span></code><a class="headerlink" href="#Simulation.dust.v.rel.rad" title="Link to this heading"></a></h5>
<p>Relative collision velocity caused by differential radial drift.</p>
<p><span class="math notranslate nohighlight">\(\Large v_{\mathrm{rel},\,\mathrm{rad}} = \left| v_{\mathrm{rad},\,i} - v_{\mathrm{rad},\,j} \right|\)</span>.</p>
</section>
<section id="Simulation.dust.v.rel.tot">
<h5><code class="docutils literal notranslate"><span class="pre">Simulation.dust.v.rel.tot</span></code><a class="headerlink" href="#Simulation.dust.v.rel.tot" title="Link to this heading"></a></h5>
<p>Total relative velocities calculated by using the root mean square of all individual velocity sources.</p>
<p><span class="math notranslate nohighlight">\(\Large v_{\mathrm{rel},\,\mathrm{tot}} = \sqrt{v_{\mathrm{rel},\,\mathrm{azi}}^2 + v_{\mathrm{rel},\,\mathrm{brown}}^2 + v_{\mathrm{rel},\,\mathrm{rad}}^2 + v_{\mathrm{rel},\,\mathrm{turb}}^2 + v_{\mathrm{rel},\,\mathrm{vert}}^2}\)</span>.</p>
</section>
<section id="Simulation.dust.v.rel.turb">
<h5><code class="docutils literal notranslate"><span class="pre">Simulation.dust.v.rel.turb</span></code><a class="headerlink" href="#Simulation.dust.v.rel.turb" title="Link to this heading"></a></h5>
<div class="line-block">
<div class="line">Relative velocities caused by turbulent motion of the particles. This follows the prescription of <a class="reference external" href="https://doi.org/10.1051/0004-6361:20066899">Ormel &amp; Cuzzi (2007)</a>.</div>
<div class="line">It uses <code class="docutils literal notranslate"><span class="pre">Simulation.dust.delta.turb</span></code> instead of <code class="docutils literal notranslate"><span class="pre">Simulation.gas.alpha</span></code> to calculate the velocities.</div>
</div>
</section>
<section id="Simulation.dust.v.rel.vert">
<h5><code class="docutils literal notranslate"><span class="pre">Simulation.dust.v.rel.vert</span></code><a class="headerlink" href="#Simulation.dust.v.rel.vert" title="Link to this heading"></a></h5>
<p>Relative collision velocities caused by differential vertical settling of particles.</p>
<p><span class="math notranslate nohighlight">\(\Large v_{\mathrm{rel},\,\mathrm{vert}} = \left| h_i \min \left( \mathrm{St}_i,\,\frac{1}{2}\right) - h_j \min \left( \mathrm{St}_j,\,\frac{1}{2}\right) \right| \cdot \Omega_\mathrm{K}\)</span>.</p>
<p>This prescription is taken from <a class="reference external" href="https://doi.org/10.1051/0004-6361/200913731">Birnstiel et al. (2010)</a> and follows <a class="reference external" href="https://doi.org/10.1051/0004-6361:20040284">Dullemond &amp; Dominik (2004)</a>.</p>
</section>
</section>
<section id="Simulation.dust.v.driftmax">
<h4><code class="docutils literal notranslate"><span class="pre">Simulation.dust.v.driftmax</span></code><a class="headerlink" href="#Simulation.dust.v.driftmax" title="Link to this heading"></a></h4>
<p>This is the maximum drift velocity a particle of <span class="math notranslate nohighlight">\(\large \mathrm{St} = 1\)</span> can have.</p>
<p><span class="math notranslate nohighlight">\(\Large v_{\mathrm{drift},\,\mathrm{max}} = \frac{1}{2} B v_\mathrm{visc} - A \eta v_\mathrm{K}\)</span>.</p>
<p>See <code class="docutils literal notranslate"><span class="pre">Simulation.dust.backreaction</span></code> for details.</p>
</section>
<section id="Simulation.dust.v.frag">
<h4><code class="docutils literal notranslate"><span class="pre">Simulation.dust.v.frag</span></code><a class="headerlink" href="#Simulation.dust.v.frag" title="Link to this heading"></a></h4>
<p>Fragmentation velocities of shape <code class="docutils literal notranslate"><span class="pre">(Simulation.grid.Nr,)</span></code>. By default this is set by the value of <code class="docutils literal notranslate"><span class="pre">Simulation.ini.dust.vfrag</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">frag</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.
 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.
 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.
 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.
 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.
 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.
 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.
 100. 100.]
</pre></div></div>
</div>
</section>
<section id="Simulation.dust.v.rad">
<h4><code class="docutils literal notranslate"><span class="pre">Simulation.dust.v.rad</span></code><a class="headerlink" href="#Simulation.dust.v.rad" title="Link to this heading"></a></h4>
<p>Radial velocities of the dust particles.</p>
<p><span class="math notranslate nohighlight">\(\Large v_\mathrm{rad} = \left( v_\mathrm{g} + 2 v_{\mathrm{drift},\,\mathrm{max}}\mathrm{St} \right) \frac{1}{\mathrm{St}^2+1}\)</span></p>
</section>
</section>
<section id="Simulation.dust.a">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.dust.a</span></code><a class="headerlink" href="#Simulation.dust.a" title="Link to this heading"></a></h3>
<p>Particle radii calculated with</p>
<p><span class="math notranslate nohighlight">\(\Large a = \sqrt[3]{\frac{3m}{4\pi\rho_\mathrm{s}}}\)</span></p>
</section>
<section id="Simulation.dust.D">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.dust.D</span></code><a class="headerlink" href="#Simulation.dust.D" title="Link to this heading"></a></h3>
<p>Dust diffusivity for every particle species of shape <code class="docutils literal notranslate"><span class="pre">(Simulation.grid.Nr,</span> <span class="pre">Simulation.grid.Nm)</span></code> calculated with</p>
<p><span class="math notranslate nohighlight">\(\Large D = \frac{\delta_\mathrm{rad}\,c_\mathrm{s}^2}{\Omega_\mathrm{K}\left( 1 + \mathrm{St}^2 \right)}\)</span>.</p>
</section>
<section id="Simulation.dust.eps">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.dust.eps</span></code><a class="headerlink" href="#Simulation.dust.eps" title="Link to this heading"></a></h3>
<p>This is the vertically integrated dust-to-gas ratio of shape <code class="docutils literal notranslate"><span class="pre">(Simulation.grid.Nr,)</span></code>. In the literature this is also often refered to as metallicity <span class="math notranslate nohighlight">\(z\)</span>. It is calculated via</p>
<p><span class="math notranslate nohighlight">\(\Large \epsilon = \frac{\sum\limits_i \Sigma_{\mathrm{d},\,i}}{\Sigma_\mathrm{g}}\)</span></p>
</section>
<section id="Simulation.dust.fill">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.dust.fill</span></code><a class="headerlink" href="#Simulation.dust.fill" title="Link to this heading"></a></h3>
<p>This describes the filling factor of the dust aggregates. By default this is 1.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">fill</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[1. 1. 1. ... 1. 1. 1.]
 [1. 1. 1. ... 1. 1. 1.]
 [1. 1. 1. ... 1. 1. 1.]
 ...
 [1. 1. 1. ... 1. 1. 1.]
 [1. 1. 1. ... 1. 1. 1.]
 [1. 1. 1. ... 1. 1. 1.]]
</pre></div></div>
</div>
</section>
<section id="Simulation.dust.H">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.dust.H</span></code><a class="headerlink" href="#Simulation.dust.H" title="Link to this heading"></a></h3>
<p>These are the dust scale heights of shape <code class="docutils literal notranslate"><span class="pre">(Simulation.grid.Nr,</span> <span class="pre">Simulation.grid.Nm)</span></code> calculated with the prescription of <a class="reference external" href="https://doi.org/10.1006/icar.1995.1058">Dubrulle et al. (1995)</a></p>
<p><span class="math notranslate nohighlight">\(\Large H_i = H_\mathrm{P} \cdot \sqrt{\frac{\delta_\mathrm{vert}}{\delta_\mathrm{vert}+\mathrm{St}_i}}\)</span></p>
<p>It is limited to a maximum of the pressure scale height <span class="math notranslate nohighlight">\(H_\mathrm{P}\)</span>. It uses <code class="docutils literal notranslate"><span class="pre">Simulation.dust.delta.vert</span></code> as vertical mixing parameter instead of <code class="docutils literal notranslate"><span class="pre">Simulation.gas.alpha</span></code>.</p>
</section>
<section id="Simulation.dust.kernel">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.dust.kernel</span></code><a class="headerlink" href="#Simulation.dust.kernel" title="Link to this heading"></a></h3>
<p>These are the vertically integrated collision kernels of shape <code class="docutils literal notranslate"><span class="pre">(Simulation.grid.Nr,</span> <span class="pre">Simulation.grid.Nm,</span> <span class="pre">Simulation.grid.Nm)</span></code> calculated with</p>
<p><span class="math notranslate nohighlight">\(\Large K_{ij} = \frac{1}{1+\delta_{ij}} \frac{\pi\left( a_i + a_j \right)^2}{\sqrt{2\pi\left( H_i^2 + H_j^2 \right)}} v_\mathrm{rel}\)</span></p>
<p>Please have a look at <a class="reference external" href="https://doi.org/10.1051/0004-6361/200913731">Birnstiel et al. (2010)</a> for details. The kernel is the geometrical cross section multiplied with the factor described in <code class="docutils literal notranslate"><span class="pre">(A.14)</span></code>. Multiplying the kernel with the densities returns the collision rates.</p>
<p>The collisions rates of equal particle collisions are reduced by a factor of <span class="math notranslate nohighlight">\(\large \frac{1}{2}\)</span> by the Kronecker <span class="math notranslate nohighlight">\(\large \delta_{ij}\)</span>. In a reservoir of <span class="math notranslate nohighlight">\(\large N\)</span> equal particles, the first particle can collide with <span class="math notranslate nohighlight">\(\large N-1\)</span> other particles, the second particle can collide with <span class="math notranslate nohighlight">\(\large N-2\)</span> other particles without counting the collision with the first particle twice. The third particle can collide with <span class="math notranslate nohighlight">\(\large N-3\)</span> other particles and so on. The total
number of possible collisions is therefore given by</p>
<p><span class="math notranslate nohighlight">\(\Large \sum\limits_{i=1}^{N-1} i = \frac{1}{2}\left(N\right)\left(N-1\right)\)</span>,</p>
<p>which is <span class="math notranslate nohighlight">\(\large \frac{1}{2}N^2\)</span> in the limit of large <span class="math notranslate nohighlight">\(\large N\)</span>.</p>
</section>
<section id="Simulation.dust.rho">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.dust.rho</span></code><a class="headerlink" href="#Simulation.dust.rho" title="Link to this heading"></a></h3>
<p>Midplane mass densities of the dust.</p>
<p><span class="math notranslate nohighlight">\(\Large \rho = \frac{\Sigma}{\sqrt{2\pi}H}\)</span></p>
</section>
<section id="Simulation.dust.rhos">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.dust.rhos</span></code><a class="headerlink" href="#Simulation.dust.rhos" title="Link to this heading"></a></h3>
<p>Solid state density of the particle material. This is initially set to <code class="docutils literal notranslate"><span class="pre">Simulation.ini.dust.rhoMonomer</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">rhos</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[1.67 1.67 1.67 ... 1.67 1.67 1.67]
 [1.67 1.67 1.67 ... 1.67 1.67 1.67]
 [1.67 1.67 1.67 ... 1.67 1.67 1.67]
 ...
 [1.67 1.67 1.67 ... 1.67 1.67 1.67]
 [1.67 1.67 1.67 ... 1.67 1.67 1.67]
 [1.67 1.67 1.67 ... 1.67 1.67 1.67]]
</pre></div></div>
</div>
<p>To calculate the mass density of a dust aggregate do</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">fill</span> <span class="o">*</span> <span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">rhos</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[1.67 1.67 1.67 ... 1.67 1.67 1.67]
 [1.67 1.67 1.67 ... 1.67 1.67 1.67]
 [1.67 1.67 1.67 ... 1.67 1.67 1.67]
 ...
 [1.67 1.67 1.67 ... 1.67 1.67 1.67]
 [1.67 1.67 1.67 ... 1.67 1.67 1.67]
 [1.67 1.67 1.67 ... 1.67 1.67 1.67]]
</pre></div></div>
</div>
<p>This is the density that is used to calculate the particle size.</p>
</section>
<section id="Simulation.dust.Sigma">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.dust.Sigma</span></code><a class="headerlink" href="#Simulation.dust.Sigma" title="Link to this heading"></a></h3>
<p>This is the dust surface density of every particle species of shape <code class="docutils literal notranslate"><span class="pre">(Simulation.grid.Nr,</span> <span class="pre">Simulation.grid.Nm)</span></code>. This is the quantity that is integrated to solve for dust evolution.</p>
<p>The surface densities are integrated over the mass bin, so a numerical summation over the mass dimension returns the total dust surface density.</p>
<p><span class="math notranslate nohighlight">\(\Large \Sigma_\mathrm{d} = \sum\limits_i \Sigma_{\mathrm{d},\,i}\)</span></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">Sigma</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[1.11815368e+01 1.04232155e+01 9.71465059e+00 9.05339692e+00
 8.43629793e+00 7.86040780e+00 7.32297742e+00 6.82144128e+00
 6.35340519e+00 5.91663488e+00 5.50904531e+00 5.12869076e+00
 4.77375546e+00 4.44254502e+00 4.13347826e+00 3.84507969e+00
 3.57597248e+00 3.32487186e+00 3.09057900e+00 2.87197527e+00
 2.66801690e+00 2.47773001e+00 2.30020595e+00 2.13459693e+00
 1.98011200e+00 1.83601326e+00 1.70161231e+00 1.57626698e+00
 1.45937826e+00 1.35038739e+00 1.24877321e+00 1.15404966e+00
 1.06576343e+00 9.83491798e-01 9.06840556e-01 8.35442144e-01
 7.68953850e-01 7.07056150e-01 6.49451154e-01 5.95861146e-01
 5.46027226e-01 4.99708026e-01 4.56678518e-01 4.16728886e-01
 3.79663471e-01 3.45299782e-01 3.13467557e-01 2.84007884e-01
 2.56772375e-01 2.31622377e-01 2.08428234e-01 1.87068586e-01
 1.67429708e-01 1.49404882e-01 1.32893806e-01 1.17802035e-01
 1.04040457e-01 9.15247991e-02 8.01751688e-02 6.99156307e-02
 6.06738170e-02 5.23805770e-02 4.49696665e-02 3.83774784e-02
 3.25428186e-02 2.74067268e-02 2.29123459e-02 1.90048396e-02
 1.56313572e-02 1.27410459e-02 1.02851052e-02 8.21687989e-03
 6.49198428e-03 5.06844837e-03 3.90687641e-03 2.97060545e-03
 2.22585132e-03 8.21564634e-28 7.15552883e-28 6.23220508e-28
 5.42802371e-28 4.72761102e-28 4.11757706e-28 3.58625970e-28
 3.12350162e-28 2.72045619e-28 2.36941829e-28 2.06367706e-28
 1.79738758e-28 1.56545914e-28 1.36345791e-28 1.18752220e-28
 1.03428860e-28 9.00827708e-29 7.84588135e-29 6.83347698e-29
 5.95170965e-29 5.18372240e-29 4.51483347e-29 3.93225557e-29]
</pre></div></div>
</div>
<p>If you want to plot the dust density distribution you might want to convert the field into a quantity that does not depend on the mass bin width. The plotting script integrated in <code class="docutils literal notranslate"><span class="pre">DustPy</span></code> is plotting a grid independent density distribution. See the first chapter for details on this.</p>
</section>
<section id="Simulation.dust.SigmaFloor">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.dust.SigmaFloor</span></code><a class="headerlink" href="#Simulation.dust.SigmaFloor" title="Link to this heading"></a></h3>
<p>This is the floor value for the dust surface densities. Mass bins that are below their respective floor value will not contribute to coagulation. By default the floor value is the density that corresponds to one physical particle of that mass distributed over an annulus at that radial grid location.</p>
<p><span class="math notranslate nohighlight">\(\Large \Sigma_{\mathrm{d},\,\mathrm{floor}} = \frac{m}{A_\mathrm{annulus}}\)</span></p>
<p>Densities below the floor value therefore correspond to fewer that one physical particle in that radial grid cell.</p>
</section>
<section id="Simulation.dust.St">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.dust.St</span></code><a class="headerlink" href="#Simulation.dust.St" title="Link to this heading"></a></h3>
<p>Stokes numbers of the particles. By default the Epstein and the Stokes I drag regime are considered.</p>
<p><span class="math notranslate nohighlight">\(\Large \mathrm{St} = \begin{cases} \frac{\pi}{2} \frac{a\rho}{\Sigma_\mathrm{g}}, &amp; \text{if } a &lt; \frac{9}{4} \lambda_\mathrm{mfp}\\ \frac{2\pi}{9} \frac{a^2 \rho}{\lambda_\mathrm{mfp} \Sigma_\mathrm{g}}, &amp; \text{else} \end{cases}\)</span></p>
</section>
<section id="Update-order">
<h3>Update order<a class="headerlink" href="#Update-order" title="Link to this heading"></a></h3>
<p>The update order of the dust quantities in the standard model is set to</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">updateorder</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;delta&#39;,
 &#39;rhos&#39;,
 &#39;fill&#39;,
 &#39;a&#39;,
 &#39;St&#39;,
 &#39;H&#39;,
 &#39;rho&#39;,
 &#39;backreaction&#39;,
 &#39;v&#39;,
 &#39;D&#39;,
 &#39;eps&#39;,
 &#39;kernel&#39;,
 &#39;p&#39;,
 &#39;S&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">backreaction</span><span class="o">.</span><span class="n">updateorder</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;A&#39;, &#39;B&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">delta</span><span class="o">.</span><span class="n">updateorder</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;rad&#39;, &#39;turb&#39;, &#39;vert&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">Fi</span><span class="o">.</span><span class="n">updateorder</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;adv&#39;, &#39;diff&#39;, &#39;tot&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">updateorder</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;frag&#39;, &#39;stick&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">updateorder</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;ext&#39;, &#39;tot&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">updateorder</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;frag&#39;, &#39;driftmax&#39;, &#39;rel&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">rel</span><span class="o">.</span><span class="n">updateorder</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;azi&#39;, &#39;brown&#39;, &#39;rad&#39;, &#39;turb&#39;, &#39;vert&#39;, &#39;tot&#39;]
</pre></div></div>
</div>
<p><strong>Note</strong>: The quantities that are excluded are calculated in the finalization step of the implicit integrator from the new values of the dust surface densities.</p>
</section>
</section>
<section id="Gas">
<h2>Gas<a class="headerlink" href="#Gas" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">gas</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Group (Gas quantities)
----------------------
    boundary     : Group (Boundary conditions)
    S            : Group (Source terms)
    torque       : Group (Torque parameters)
    v            : Group (Velocities)
  -----
    alpha        : Field (Turbulent alpha parameter)
    cs           : Field (Isothermal sound speed [cm/s])
    eta          : Field (Pressure gradient parameter)
    Fi           : Field (Gas flux interfaces [g/cm/s])
    Hp           : Field (Pressure scale height [cm])
    mfp          : Field (Midplane mean free path [cm])
    mu           : Field (Mean molecular weight [g])
    n            : Field (Miplane number density [1/cm³])
    nu           : Field (Kinematic viscosity [cm²/s])
    P            : Field (Midplane pressure [g/cm/s²])
    rho          : Field (Miplane mass density [g/cm³])
    Sigma        : Field (Surface density [g/cm²])
    SigmaFloor   : Field (Floor value of surface density [g/cm²])
    T            : Field (Temperature [K])
  -----
</pre></div></div>
</div>
<section id="Simulation.gas.boundary">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.gas.boundary</span></code><a class="headerlink" href="#Simulation.gas.boundary" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">boundary</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Group (Boundary conditions)
---------------------------
    inner        : Boundary
    outer        : Boundary
  -----
</pre></div></div>
</div>
<p>These are the boundary conditions of the gas. By default the inner boundary is set to constant gradient and the outer boundary to floor value.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">inner</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Constant gradient
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">outer</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Value
</pre></div></div>
</div>
<p>The boundary conditions can be modified with <code class="docutils literal notranslate"><span class="pre">setcondition</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">inner</span><span class="o">.</span><span class="n">setcondition</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on method setcondition in module dustpy.utils.boundary:

setcondition(condition, value=None) method of dustpy.utils.boundary.Boundary instance
    Function to set boundary condition.

    Parameters
    ----------
    condition : string
        Type of boundary conditon:
            - &#34;const_grad&#34; : constant gradient
            - &#34;const_pow&#34; : constant power law
            - &#34;const_val&#34; : constant value
            - &#34;val&#34; : custom value
            - &#34;grad&#34; : custom gradient
            - &#34;pow&#34; : custom power law with set exponent
            - None : Don&#39;t impose boundary condition (default)
    value : float or array, optional, default : None
        Value if needed for boundary condition

</pre></div></div>
</div>
<p>If the gas surface density follows a power law <span class="math notranslate nohighlight">\(\propto R^{-1}\)</span> the constant gradient boundary condition should work fine. Other values can lead to deviations at the inner boundary. See the chapter about gas evolution tests for details.</p>
</section>
<section id="Simulation.gas.S">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.gas.S</span></code><a class="headerlink" href="#Simulation.gas.S" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">S</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Group (Source terms)
--------------------
    ext          : Field (External sources [g/cm²/s])
    hyd          : Field (Hydrodynamic sources [g/cm²/s])
    tot          : Field (Total sources [g/cm²/s])
  -----
</pre></div></div>
</div>
<p>These are the source terms of the gas.</p>
<section id="Simulation.gas.S.ext">
<h4><code class="docutils literal notranslate"><span class="pre">Simulation.gas.S.ext</span></code><a class="headerlink" href="#Simulation.gas.S.ext" title="Link to this heading"></a></h4>
<p>These are the external source terms for gas evolution, e.g. infall. By default these are set to zero.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">ext</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0.]
</pre></div></div>
</div>
</section>
<section id="Simulation.gas.S.hyd">
<h4><code class="docutils literal notranslate"><span class="pre">Simulation.gas.S.hyd</span></code><a class="headerlink" href="#Simulation.gas.S.hyd" title="Link to this heading"></a></h4>
<div class="line-block">
<div class="line">These are the hydrodynamic source terms of the gas evolution.</div>
<div class="line"><strong>Attention:</strong> Since the gas evolution is calculated implicitly, the hydrodynamic source terms are calculated in retrospect after the new gas surface density was found. Changing <code class="docutils literal notranslate"><span class="pre">Simulation.gas.S.hyd</span></code> does not influence the simulation. It is only given for data analysis.</div>
</div>
</section>
<section id="Simulation.gas.S.tot">
<h4><code class="docutils literal notranslate"><span class="pre">Simulation.gas.S.tot</span></code><a class="headerlink" href="#Simulation.gas.S.tot" title="Link to this heading"></a></h4>
<p>These are the total source terms of gas evolution.</p>
<p><span class="math notranslate nohighlight">\(\Large S_\mathrm{tot} = S_\mathrm{ext} + S_\mathrm{hyd}\)</span></p>
<p><strong>Attention:</strong> Since the gas evolution is calculated implicitly, the total source terms are calculated in retrospect after the new gas surface density was found. Changing <code class="docutils literal notranslate"><span class="pre">Simulation.gas.S.tot</span></code> does not influence the simulation. It is only given for data analysis.</p>
</section>
</section>
<section id="Simulation.gas.torque">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.gas.torque</span></code><a class="headerlink" href="#Simulation.gas.torque" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">torque</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Group (Torque parameters)
-------------------------
    Lambda       : Field (Specific angular momentum injection rate by torque [cm²/s²])
    v            : Field (Effective velocity imposed by torque [cm/s])
  -----
</pre></div></div>
</div>
<section id="Simulation.gas.torque.Lambda">
<h4><code class="docutils literal notranslate"><span class="pre">Simulation.gas.torque.Lambda</span></code><a class="headerlink" href="#Simulation.gas.torque.Lambda" title="Link to this heading"></a></h4>
<p>This is the specific angular momentum injection, i.e., an additional torque acting on the gas.</p>
</section>
<section id="Simulation.gas.torque.v">
<h4><code class="docutils literal notranslate"><span class="pre">Simulation.gas.torque.v</span></code><a class="headerlink" href="#Simulation.gas.torque.v" title="Link to this heading"></a></h4>
<p>This is resulting velocity component imposed by the torque on the gas.</p>
<p><span class="math notranslate nohighlight">\(\Large v_\mathrm{torque} = 2 \frac{\Lambda}{r\Omega_\mathrm{K}}\)</span></p>
</section>
</section>
<section id="Simulation.gas.v">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.gas.v</span></code><a class="headerlink" href="#Simulation.gas.v" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">v</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Group (Velocities)
------------------
    rad          : Field (Radial velocity [cm/s])
    visc         : Field (Viscous accretion velocity [cm/s])
  -----
</pre></div></div>
</div>
<div class="line-block">
<div class="line">These are velocities that are relevant for the gas evolution.</div>
<div class="line"><strong>Attention:</strong> Since the gas evolution is calculated implicitly, the velocities are calculated in retrospect after the new gas surface density was found. Changing anything in <code class="docutils literal notranslate"><span class="pre">Simulation.gas.v</span></code> does not influence the simulation. It is only given for data analysis.</div>
</div>
<section id="Simulation.gas.v.rad">
<h4><code class="docutils literal notranslate"><span class="pre">Simulation.gas.v.rad</span></code><a class="headerlink" href="#Simulation.gas.v.rad" title="Link to this heading"></a></h4>
<p>This is the radial gas velocity. It is given by</p>
<p><span class="math notranslate nohighlight">\(\Large v_\mathrm{g} = Av_\mathrm{visc} + 2B\eta v_\mathrm{K}\)</span>.</p>
<div class="line-block">
<div class="line">See <code class="docutils literal notranslate"><span class="pre">Simulation.dust.backreaction</span></code> for details. If backreaction is turned off, i.e., <span class="math notranslate nohighlight">\(A=1\)</span> and <span class="math notranslate nohighlight">\(B=0\)</span>, the radial velocity is identical to the viscous velocity.</div>
<div class="line"><strong>Attention:</strong> Since the gas evolution is calculated implicitly, the velocities are calculated in retrospect after the new gas surface density was found. Changing anything in <code class="docutils literal notranslate"><span class="pre">Simulation.gas.v.rad</span></code> does not influence the simulation. It is only given for data analysis.</div>
</div>
</section>
<section id="Simulation.gas.v.visc">
<h4><code class="docutils literal notranslate"><span class="pre">Simulation.gas.v.visc</span></code><a class="headerlink" href="#Simulation.gas.v.visc" title="Link to this heading"></a></h4>
<p>This is the radial viscous gas velocity</p>
<p><span class="math notranslate nohighlight">\(\Large v_\mathrm{visc} = -\frac{3}{\Sigma_\mathrm{g}\sqrt{R}} \frac{\partial}{\partial R} \left( \Sigma_\mathrm{g} \nu \sqrt{R} \right)\)</span></p>
<p><strong>Attention:</strong> Since the gas evolution is calculated implicitly, the velocities are calculated in retrospect after the new gas surface density was found. Changing anything in <code class="docutils literal notranslate"><span class="pre">Simulation.gas.v.visc</span></code> does not influence the simulation. It is only given for data analysis.</p>
</section>
</section>
<section id="Simulation.gas.alpha">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.gas.alpha</span></code><a class="headerlink" href="#Simulation.gas.alpha" title="Link to this heading"></a></h3>
<p>This is the turbulent viscosity parameter according <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1973A%26A....24..337S/abstract">Shakura &amp; Sunyaev (1973)</a>. It is initially set to the value in <code class="docutils literal notranslate"><span class="pre">Simulation.ini.gas.alpha</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">alpha</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
 0.001 0.001 0.001 0.001]
</pre></div></div>
</div>
</section>
<section id="Simulation.gas.cs">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.gas.cs</span></code><a class="headerlink" href="#Simulation.gas.cs" title="Link to this heading"></a></h3>
<p>This is the isothermal sound speed in the midplane of the disk</p>
<p><span class="math notranslate nohighlight">\(\Large c_\mathrm{s} = \sqrt{\frac{k_\mathrm{B} T}{\mu}}\)</span>.</p>
</section>
<section id="Simulation.gas.eta">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.gas.eta</span></code><a class="headerlink" href="#Simulation.gas.eta" title="Link to this heading"></a></h3>
<p>This is the midplane pressure gradient parameter <span class="math notranslate nohighlight">\(\large \eta\)</span> given by</p>
<p><span class="math notranslate nohighlight">\(\Large \eta = -\frac{1}{2} \left( \frac{H_\mathrm{P}}{r} \right)^2 \frac{\partial \log P}{\partial \log r}\)</span></p>
<p>It describes the degree of “sub-Keplerity” of the disk</p>
<p><span class="math notranslate nohighlight">\(\Large v_\phi^2 = \left( 1-2\eta \right) v_\mathrm{K}^2\)</span>.</p>
</section>
<section id="Simulation.gas.Fi">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.gas.Fi</span></code><a class="headerlink" href="#Simulation.gas.Fi" title="Link to this heading"></a></h3>
<div class="line-block">
<div class="line">These are the mass fluxes of gas through the grid cell interfaces.</div>
<div class="line"><strong>Attention:</strong> Since the gas evolution is calculated implicitly, the fluxes are calculated in retrospect after the new gas surface density was found. Changing anything in <code class="docutils literal notranslate"><span class="pre">Simulation.gas.Fi</span></code> does not influence the simulation. It is only given for data analysis.</div>
</div>
</section>
<section id="Simulation.gas.Hp">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.gas.Hp</span></code><a class="headerlink" href="#Simulation.gas.Hp" title="Link to this heading"></a></h3>
<p>Pressure scale height of the gas given by the ratio of the isothermal sound speed to the Keplerian frequency.</p>
<p><span class="math notranslate nohighlight">\(\Large H_\mathrm{P} = \frac{c_\mathrm{s}}{\Omega_\mathrm{K}}\)</span>.</p>
</section>
<section id="Simulation.gas.mfp">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.gas.mfp</span></code><a class="headerlink" href="#Simulation.gas.mfp" title="Link to this heading"></a></h3>
<p>Mean free path of the gas in the midplane of the disk</p>
<p><span class="math notranslate nohighlight">\(\Large \lambda_\mathrm{mfp} = \frac{1}{\sqrt{2}\,n\,\sigma_\mathrm{H_2}}\)</span></p>
</section>
<section id="Simulation.gas.mu">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.gas.mu</span></code><a class="headerlink" href="#Simulation.gas.mu" title="Link to this heading"></a></h3>
<p>Mean molecular weight of the gas. This is initially set by the value given in <code class="docutils literal notranslate"><span class="pre">Simulation.ini.gas.mu</span></code> and is equal to <span class="math notranslate nohighlight">\(2.3\,m_\mathrm{P}\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">mu</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[3.84703042e-24 3.84703042e-24 3.84703042e-24 3.84703042e-24
 3.84703042e-24 3.84703042e-24 3.84703042e-24 3.84703042e-24
 3.84703042e-24 3.84703042e-24 3.84703042e-24 3.84703042e-24
 3.84703042e-24 3.84703042e-24 3.84703042e-24 3.84703042e-24
 3.84703042e-24 3.84703042e-24 3.84703042e-24 3.84703042e-24
 3.84703042e-24 3.84703042e-24 3.84703042e-24 3.84703042e-24
 3.84703042e-24 3.84703042e-24 3.84703042e-24 3.84703042e-24
 3.84703042e-24 3.84703042e-24 3.84703042e-24 3.84703042e-24
 3.84703042e-24 3.84703042e-24 3.84703042e-24 3.84703042e-24
 3.84703042e-24 3.84703042e-24 3.84703042e-24 3.84703042e-24
 3.84703042e-24 3.84703042e-24 3.84703042e-24 3.84703042e-24
 3.84703042e-24 3.84703042e-24 3.84703042e-24 3.84703042e-24
 3.84703042e-24 3.84703042e-24 3.84703042e-24 3.84703042e-24
 3.84703042e-24 3.84703042e-24 3.84703042e-24 3.84703042e-24
 3.84703042e-24 3.84703042e-24 3.84703042e-24 3.84703042e-24
 3.84703042e-24 3.84703042e-24 3.84703042e-24 3.84703042e-24
 3.84703042e-24 3.84703042e-24 3.84703042e-24 3.84703042e-24
 3.84703042e-24 3.84703042e-24 3.84703042e-24 3.84703042e-24
 3.84703042e-24 3.84703042e-24 3.84703042e-24 3.84703042e-24
 3.84703042e-24 3.84703042e-24 3.84703042e-24 3.84703042e-24
 3.84703042e-24 3.84703042e-24 3.84703042e-24 3.84703042e-24
 3.84703042e-24 3.84703042e-24 3.84703042e-24 3.84703042e-24
 3.84703042e-24 3.84703042e-24 3.84703042e-24 3.84703042e-24
 3.84703042e-24 3.84703042e-24 3.84703042e-24 3.84703042e-24
 3.84703042e-24 3.84703042e-24 3.84703042e-24 3.84703042e-24]
</pre></div></div>
</div>
</section>
<section id="Simulation.gas.n">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.gas.n</span></code><a class="headerlink" href="#Simulation.gas.n" title="Link to this heading"></a></h3>
<p>Midplane number density of the gas given by</p>
<p><span class="math notranslate nohighlight">\(\Large n = \frac{\rho}{\mu}\)</span></p>
</section>
<section id="Simulation.gas.nu">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.gas.nu</span></code><a class="headerlink" href="#Simulation.gas.nu" title="Link to this heading"></a></h3>
<p>Kinematic viscosity of the gas given by</p>
<p><span class="math notranslate nohighlight">\(\Large \nu = \alpha c_\mathrm{s} H_\mathrm{P}\)</span>.</p>
</section>
<section id="Simulation.gas.P">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.gas.P</span></code><a class="headerlink" href="#Simulation.gas.P" title="Link to this heading"></a></h3>
<p>Midplane gas pressure given by</p>
<p><span class="math notranslate nohighlight">\(\Large P = \rho\,c_\mathrm{s}^2\)</span>.</p>
</section>
<section id="Simulation.gas.rho">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.gas.rho</span></code><a class="headerlink" href="#Simulation.gas.rho" title="Link to this heading"></a></h3>
<p>Midplane gas mass density given by</p>
<p><span class="math notranslate nohighlight">\(\Large \rho = \frac{\Sigma_\mathrm{g}}{\sqrt{2\pi}H_\mathrm{P}}\)</span>.</p>
</section>
<section id="Simulation.gas.Sigma">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.gas.Sigma</span></code><a class="headerlink" href="#Simulation.gas.Sigma" title="Link to this heading"></a></h3>
<p>Gas surface density. This is the quantity that is integrated with an implicit Euler first-order scheme.</p>
</section>
<section id="Simulation.gas.SigmaFloor">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.gas.SigmaFloor</span></code><a class="headerlink" href="#Simulation.gas.SigmaFloor" title="Link to this heading"></a></h3>
<p>This is the floor value of the gas surface density. By default it is <span class="math notranslate nohighlight">\(10^{-100}\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">SigmaFloor</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100
 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100
 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100
 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100
 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100
 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100
 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100
 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100
 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100
 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100
 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100 1.e-100
 1.e-100]
</pre></div></div>
</div>
<p>If the gas surface density is at any point below it’s floor value it will be automatically set to the floor value at the end of a time step.</p>
</section>
<section id="Simulation.gas.T">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.gas.T</span></code><a class="headerlink" href="#Simulation.gas.T" title="Link to this heading"></a></h3>
<p>This is the midplane gas temperature. It is calculated by assuming a passively irradiated disk with a constant irradiation angle of <span class="math notranslate nohighlight">\(0.05\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\Large T\left( r \right) = \sqrt[4]{\frac{1}{2}\frac{0.05\,L_*}{4\,\pi\,r^2\,\sigma_\mathrm{SB}}}\)</span></p>
</section>
<section id="id1">
<h3>Update order<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<p>The update order of the gas quantities in the standard model is set to</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">updateorder</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;mu&#39;,
 &#39;T&#39;,
 &#39;alpha&#39;,
 &#39;cs&#39;,
 &#39;Hp&#39;,
 &#39;nu&#39;,
 &#39;rho&#39;,
 &#39;n&#39;,
 &#39;mfp&#39;,
 &#39;P&#39;,
 &#39;eta&#39;,
 &#39;torque&#39;,
 &#39;S&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">updateorder</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;ext&#39;, &#39;tot&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">updateorder</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;visc&#39;, &#39;rad&#39;]
</pre></div></div>
</div>
<p><strong>Note</strong>: The quantities that are excluded are calculated in the finalization step of the implicit integrator from the new values of the surface densities.</p>
</section>
</section>
<section id="Grid">
<h2>Grid<a class="headerlink" href="#Grid" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">grid</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Group (Grid quantities)
-----------------------
    A            : Field (Radial grid annulus area [cm²]), <span class="ansi-magenta-intense-fg">constant</span>
    m            : Field (Mass grid [g]), <span class="ansi-magenta-intense-fg">constant</span>
    Nm           : Field (# of mass bins), <span class="ansi-magenta-intense-fg">constant</span>
    Nr           : Field (# of radial grid cells), <span class="ansi-magenta-intense-fg">constant</span>
    OmegaK       : Field (Keplerian frequency [1/s])
    r            : Field (Radial grid cell centers [cm]), <span class="ansi-magenta-intense-fg">constant</span>
    ri           : Field (Radial grid cell interfaces [cm]), <span class="ansi-magenta-intense-fg">constant</span>
  -----
</pre></div></div>
</div>
<p>These are all quantities that define the radial and the mass grid. Once they are defined they are constant and should not be changed. Additionally, the Keplerian frequency is located here.</p>
<section id="Simulation.grid.A">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.grid.A</span></code><a class="headerlink" href="#Simulation.grid.A" title="Link to this heading"></a></h3>
<p>Surface area of the annulus a grid cell spans.</p>
<p><span class="math notranslate nohighlight">\(\Large A_i = \pi \left( r_{i+\frac{1}{2}}^2 - r_{i-\frac{1}{2}}^2 \right)\)</span></p>
</section>
<section id="Simulation.grid.m">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.grid.m</span></code><a class="headerlink" href="#Simulation.grid.m" title="Link to this heading"></a></h3>
<p>The mass grid. It has to be strictly logarithmic. Please only use <code class="docutils literal notranslate"><span class="pre">Simulation.ini.dust.mmin</span></code>, <code class="docutils literal notranslate"><span class="pre">Simulation.ini.dust.mmax</span></code>, and <code class="docutils literal notranslate"><span class="pre">Simulation.ini.dust.Nmbpd</span></code> to set the mass grid and do not set it manually!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">m</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[1.00000000e-12 1.38949549e-12 1.93069773e-12 2.68269580e-12
 3.72759372e-12 5.17947468e-12 7.19685673e-12 1.00000000e-11
 1.38949549e-11 1.93069773e-11 2.68269580e-11 3.72759372e-11
 5.17947468e-11 7.19685673e-11 1.00000000e-10 1.38949549e-10
 1.93069773e-10 2.68269580e-10 3.72759372e-10 5.17947468e-10
 7.19685673e-10 1.00000000e-09 1.38949549e-09 1.93069773e-09
 2.68269580e-09 3.72759372e-09 5.17947468e-09 7.19685673e-09
 1.00000000e-08 1.38949549e-08 1.93069773e-08 2.68269580e-08
 3.72759372e-08 5.17947468e-08 7.19685673e-08 1.00000000e-07
 1.38949549e-07 1.93069773e-07 2.68269580e-07 3.72759372e-07
 5.17947468e-07 7.19685673e-07 1.00000000e-06 1.38949549e-06
 1.93069773e-06 2.68269580e-06 3.72759372e-06 5.17947468e-06
 7.19685673e-06 1.00000000e-05 1.38949549e-05 1.93069773e-05
 2.68269580e-05 3.72759372e-05 5.17947468e-05 7.19685673e-05
 1.00000000e-04 1.38949549e-04 1.93069773e-04 2.68269580e-04
 3.72759372e-04 5.17947468e-04 7.19685673e-04 1.00000000e-03
 1.38949549e-03 1.93069773e-03 2.68269580e-03 3.72759372e-03
 5.17947468e-03 7.19685673e-03 1.00000000e-02 1.38949549e-02
 1.93069773e-02 2.68269580e-02 3.72759372e-02 5.17947468e-02
 7.19685673e-02 1.00000000e-01 1.38949549e-01 1.93069773e-01
 2.68269580e-01 3.72759372e-01 5.17947468e-01 7.19685673e-01
 1.00000000e+00 1.38949549e+00 1.93069773e+00 2.68269580e+00
 3.72759372e+00 5.17947468e+00 7.19685673e+00 1.00000000e+01
 1.38949549e+01 1.93069773e+01 2.68269580e+01 3.72759372e+01
 5.17947468e+01 7.19685673e+01 1.00000000e+02 1.38949549e+02
 1.93069773e+02 2.68269580e+02 3.72759372e+02 5.17947468e+02
 7.19685673e+02 1.00000000e+03 1.38949549e+03 1.93069773e+03
 2.68269580e+03 3.72759372e+03 5.17947468e+03 7.19685673e+03
 1.00000000e+04 1.38949549e+04 1.93069773e+04 2.68269580e+04
 3.72759372e+04 5.17947468e+04 7.19685673e+04 1.00000000e+05]
</pre></div></div>
</div>
</section>
<section id="Simulation.grid.Nm">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.grid.Nm</span></code><a class="headerlink" href="#Simulation.grid.Nm" title="Link to this heading"></a></h3>
<p>Number of mass bins.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">Nm</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
120
</pre></div></div>
</div>
</section>
<section id="Simulation.grid.Nr">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.grid.Nr</span></code><a class="headerlink" href="#Simulation.grid.Nr" title="Link to this heading"></a></h3>
<p>Number of radial grid cells.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">Nr</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
100
</pre></div></div>
</div>
</section>
<section id="Simulation.grid.OmegaK">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.grid.OmegaK</span></code><a class="headerlink" href="#Simulation.grid.OmegaK" title="Link to this heading"></a></h3>
<p>Keplerian frequency given by</p>
<p><span class="math notranslate nohighlight">\(\Large \Omega_\mathrm{K} = \sqrt{\frac{G\,M_*}{r^3}}\)</span>.</p>
</section>
<section id="Simulation.grid.r">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.grid.r</span></code><a class="headerlink" href="#Simulation.grid.r" title="Link to this heading"></a></h3>
<p>Radial grid cell centers. The radial grid cell centers are exactly in the middle between the grid cell interfaces.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">r</span> <span class="o">==</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">ri</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">sim</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">ri</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[ True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True]
</pre></div></div>
</div>
</section>
<section id="Simulation.grid.ri">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.grid.ri</span></code><a class="headerlink" href="#Simulation.grid.ri" title="Link to this heading"></a></h3>
<p>Locations of the grid cell interfaces. <code class="docutils literal notranslate"><span class="pre">Simulation.grid.ri[0]</span></code> and <code class="docutils literal notranslate"><span class="pre">Simulation.grid.ri[-1]</span></code> are the inner and outer grid boundaries.</p>
</section>
<section id="id2">
<h3>Update order<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<p>The update order of the grid quantities in the standard model is set to</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">updateorder</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;OmegaK&#39;]
</pre></div></div>
</div>
</section>
</section>
<section id="Star">
<h2>Star<a class="headerlink" href="#Star" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">star</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Group (Stellar quantities)
--------------------------
    L            : Field (Luminosity [erg/s])
    M            : Field (Mass [g])
    R            : Field (Radius [cm])
    T            : Field (Effective temperature [K])
  -----
</pre></div></div>
</div>
<section id="Simulation.star.L">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.star.L</span></code><a class="headerlink" href="#Simulation.star.L" title="Link to this heading"></a></h3>
<p>Stellar luminosity given by</p>
<p><span class="math notranslate nohighlight">\(\Large L = 4\pi\,R_*^2\,\sigma_\mathrm{SB}\,T_*^4\)</span></p>
</section>
<section id="Simulation.star.M">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.star.M</span></code><a class="headerlink" href="#Simulation.star.M" title="Link to this heading"></a></h3>
<p>Stellar mass. Initially set to the value given in <code class="docutils literal notranslate"><span class="pre">Simulation.ini.star.M</span></code>, which corresponds to one Solar mass.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">star</span><span class="o">.</span><span class="n">M</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.988409870698051e+33
</pre></div></div>
</div>
</section>
<section id="Simulation.star.R">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.star.R</span></code><a class="headerlink" href="#Simulation.star.R" title="Link to this heading"></a></h3>
<p>Stellar radius. Initially set to the value given in <code class="docutils literal notranslate"><span class="pre">Simulation.ini.star.R</span></code>, which corresponds to 2 Solar radii.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">star</span><span class="o">.</span><span class="n">R</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
139140000000.0
</pre></div></div>
</div>
</section>
<section id="Simulation.star.T">
<h3><code class="docutils literal notranslate"><span class="pre">Simulation.star.T</span></code><a class="headerlink" href="#Simulation.star.T" title="Link to this heading"></a></h3>
<p>Stellar effective surface temperature. Initially set to the value given in <code class="docutils literal notranslate"><span class="pre">Simulation.ini.star.T</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">star</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
5772.0
</pre></div></div>
</div>
</section>
<section id="id3">
<h3>Update order<a class="headerlink" href="#id3" title="Link to this heading"></a></h3>
<p>The update order of the stellar quantities in the standard model is set to</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">star</span><span class="o">.</span><span class="n">updateorder</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;M&#39;, &#39;R&#39;, &#39;T&#39;, &#39;L&#39;]
</pre></div></div>
</div>
</section>
</section>
<section id="Time">
<h2>Time<a class="headerlink" href="#Time" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">Simulation.t</span></code> is the current time and the integration variable. It starts at zero initially.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[63]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">t</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[63]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.0
</pre></div></div>
</div>
<p>Snapshots are written initially and between <span class="math notranslate nohighlight">\(10^3\)</span> years and <span class="math notranslate nohighlight">\(10^5\)</span> years with 10 snapshots per time decade.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">snapshots</span> <span class="o">/</span> <span class="n">c</span><span class="o">.</span><span class="n">year</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([     0.        ,   1000.        ,   1258.92541179,   1584.89319246,
         1995.26231497,   2511.88643151,   3162.27766017,   3981.07170553,
         5011.87233627,   6309.5734448 ,   7943.28234724,  10000.        ,
        12589.25411794,  15848.93192461,  19952.62314969,  25118.8643151 ,
        31622.77660168,  39810.71705535,  50118.72336273,  63095.73444802,
        79432.82347243, 100000.        ])
</pre></div></div>
</div>
<p>The timestep is calculated from the dust and the gas source terms and the current values of the surface densities of dust and gas, while using a safety factor of <code class="docutils literal notranslate"><span class="pre">0.1</span></code>, which can be accessed as an attribute of the integration variable.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">cfl</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.1
</pre></div></div>
</div>
</section>
<section id="Integrator">
<h2>Integrator<a class="headerlink" href="#Integrator" title="Link to this heading"></a></h2>
<p>The integrator that is used by default as two integration instructions. One for the gas and one for the dust.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[66]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">integrator</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[66]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Integrator (Default integrator)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[67]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">integrator</span><span class="o">.</span><span class="n">instructions</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[67]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[Instruction (Dust: implicit 1st-order direct solver),
 Instruction (Gas: implicit 1st-order direct solver)]
</pre></div></div>
</div>
<p>The gas is integrated with an implicit first-order Euler integration scheme. The Jacobian is calculated from the parameters given in <code class="docutils literal notranslate"><span class="pre">Simulation.gas</span></code>. Parameters like gas velocities, fluxes and source terms are calculated once the new values of the gas surface density have been found.</p>
<p>Except for the values at the boundaries, the advective source terms are given by</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[68]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">Sigma</span><span class="o">.</span><span class="n">jacobian</span><span class="p">()</span> <span class="o">@</span> <span class="n">sim</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">Sigma</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[68]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 0.00000000e+00, -2.24554074e-11, -1.28245730e-11, -1.19401494e-11,
       -1.11148159e-11, -1.03446325e-11, -9.62592272e-12, -8.95525542e-12,
       -8.32942893e-12, -7.74545561e-12, -7.20054754e-12, -6.69210327e-12,
       -6.21769537e-12, -5.77505884e-12, -5.36208028e-12, -4.97678783e-12,
       -4.61734171e-12, -4.28202542e-12, -3.96923760e-12, -3.67748429e-12,
       -3.40537185e-12, -3.15160026e-12, -2.91495689e-12, -2.69431072e-12,
       -2.48860688e-12, -2.29686163e-12, -2.11815758e-12, -1.95163935e-12,
       -1.79650937e-12, -1.65202409e-12, -1.51749035e-12, -1.39226203e-12,
       -1.27573691e-12, -1.16735370e-12, -1.06658934e-12, -9.72956377e-13,
       -8.86000545e-13, -8.05298528e-13, -7.30455801e-13, -6.61104640e-13,
       -5.96902226e-13, -5.37528872e-13, -4.82686334e-13, -4.32096229e-13,
       -3.85498522e-13, -3.42650098e-13, -3.03323405e-13, -2.67305162e-13,
       -2.34395125e-13, -2.04404922e-13, -1.77156935e-13, -1.52483246e-13,
       -1.30224635e-13, -1.10229637e-13, -9.23536629e-14, -7.64581809e-14,
       -6.24099739e-14, -5.00804702e-14, -3.93451606e-14, -3.00831086e-14,
       -2.21765618e-14, -1.55106732e-14, -9.97333923e-15, -5.45516066e-15,
       -1.84952901e-15,  9.47161787e-16,  3.03518347e-15,  4.51103139e-15,
        5.46688863e-15,  5.99001905e-15,  6.16211838e-15,  6.05865865e-15,
        5.74826584e-15,  5.29217356e-15,  4.74379596e-15,  4.14846024e-15,
        3.54333218e-15,  2.95755864e-15,  2.41263665e-15,  1.92300330e-15,
        1.49682302e-15,  1.13693247e-15,  8.41889128e-16,  6.07060278e-16,
        4.25685886e-16,  2.89852280e-16,  1.91324387e-16,  1.22200347e-16,
        7.53720469e-17,  4.47954544e-17,  2.55925304e-17,  1.40195607e-17,
        7.34338072e-18,  3.66694514e-18,  1.74007661e-18,  7.81976568e-19,
        3.31571497e-19,  1.32129435e-19,  3.26356417e-20,  0.00000000e+00])
</pre></div></div>
</div>
<p>The total source terms, i.e., including external sources and excluding the boundaries are given by</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[69]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">Sigma</span><span class="o">.</span><span class="n">jacobian</span><span class="p">()</span> <span class="o">@</span> <span class="n">sim</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">Sigma</span> <span class="o">+</span> <span class="n">sim</span><span class="o">.</span><span class="n">gas</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">ext</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[69]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[ 0.00000000e+00 -2.24554074e-11 -1.28245730e-11 -1.19401494e-11
 -1.11148159e-11 -1.03446325e-11 -9.62592272e-12 -8.95525542e-12
 -8.32942893e-12 -7.74545561e-12 -7.20054754e-12 -6.69210327e-12
 -6.21769537e-12 -5.77505884e-12 -5.36208028e-12 -4.97678783e-12
 -4.61734171e-12 -4.28202542e-12 -3.96923760e-12 -3.67748429e-12
 -3.40537185e-12 -3.15160026e-12 -2.91495689e-12 -2.69431072e-12
 -2.48860688e-12 -2.29686163e-12 -2.11815758e-12 -1.95163935e-12
 -1.79650937e-12 -1.65202409e-12 -1.51749035e-12 -1.39226203e-12
 -1.27573691e-12 -1.16735370e-12 -1.06658934e-12 -9.72956377e-13
 -8.86000545e-13 -8.05298528e-13 -7.30455801e-13 -6.61104640e-13
 -5.96902226e-13 -5.37528872e-13 -4.82686334e-13 -4.32096229e-13
 -3.85498522e-13 -3.42650098e-13 -3.03323405e-13 -2.67305162e-13
 -2.34395125e-13 -2.04404922e-13 -1.77156935e-13 -1.52483246e-13
 -1.30224635e-13 -1.10229637e-13 -9.23536629e-14 -7.64581809e-14
 -6.24099739e-14 -5.00804702e-14 -3.93451606e-14 -3.00831086e-14
 -2.21765618e-14 -1.55106732e-14 -9.97333923e-15 -5.45516066e-15
 -1.84952901e-15  9.47161787e-16  3.03518347e-15  4.51103139e-15
  5.46688863e-15  5.99001905e-15  6.16211838e-15  6.05865865e-15
  5.74826584e-15  5.29217356e-15  4.74379596e-15  4.14846024e-15
  3.54333218e-15  2.95755864e-15  2.41263665e-15  1.92300330e-15
  1.49682302e-15  1.13693247e-15  8.41889128e-16  6.07060278e-16
  4.25685886e-16  2.89852280e-16  1.91324387e-16  1.22200347e-16
  7.53720469e-17  4.47954544e-17  2.55925304e-17  1.40195607e-17
  7.34338072e-18  3.66694514e-18  1.74007661e-18  7.81976568e-19
  3.31571497e-19  1.32129435e-19  3.26356417e-20  0.00000000e+00]
</pre></div></div>
</div>
<p>The dust is integrated with an implicit first-order Euler integration scheme. The Jacobian is calculated from the parameters given in <code class="docutils literal notranslate"><span class="pre">Simulation.dust</span></code>. Parameters like gas velocities, fluxes and source terms are calculated once the new values of the gas surface density have been found.</p>
<p>Except for the values at the boundaries, the hydrodynamic and coagulation source terms are given by</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">Sigma</span><span class="o">.</span><span class="n">jacobian</span><span class="p">()</span> <span class="o">@</span> <span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">Sigma</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">Sigma</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[ 6.68953651e-07,  7.06651934e-07,  7.46474670e-07, ...,
         1.97766224e-30,  2.74795277e-30,  3.81826800e-30],
       [-6.22972227e-08, -6.59093722e-08, -4.66675265e-08, ...,
        -4.62358112e-34, -7.18118924e-34, -1.05367134e-33],
       [-4.88007894e-08, -5.16275634e-08, -3.65566419e-08, ...,
        -7.21301772e-34, -1.17370751e-33, -1.85366372e-33],
       ...,
       [-8.55228788e-59, -1.06505358e-58, -1.32632729e-58, ...,
        -1.18906666e-47, -1.48062233e-47, -1.84366661e-47],
       [-3.15600556e-59, -3.92990611e-59, -4.89356539e-59, ...,
        -4.38560444e-48, -5.46094186e-48, -6.79994888e-48],
       [ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00, ...,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00]],
      shape=(100, 120))
</pre></div></div>
</div>
<p>Note the <code class="docutils literal notranslate"><span class="pre">ravel()</span></code> and <code class="docutils literal notranslate"><span class="pre">reshape()</span></code> operations, since the Jacobian works on a one-dimensional state vector.</p>
<p>The total source terms except at the boundaries are given by</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[71]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">Sigma</span><span class="o">.</span><span class="n">jacobian</span><span class="p">()</span> <span class="o">@</span> <span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">Sigma</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">Sigma</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">+</span> <span class="n">sim</span><span class="o">.</span><span class="n">dust</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">ext</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[71]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[ 6.68953651e-07  7.06651934e-07  7.46474670e-07 ...  1.97766224e-30
   2.74795277e-30  3.81826800e-30]
 [-6.22972227e-08 -6.59093722e-08 -4.66675265e-08 ... -4.62358112e-34
  -7.18118924e-34 -1.05367134e-33]
 [-4.88007894e-08 -5.16275634e-08 -3.65566419e-08 ... -7.21301772e-34
  -1.17370751e-33 -1.85366372e-33]
 ...
 [-8.55228788e-59 -1.06505358e-58 -1.32632729e-58 ... -1.18906666e-47
  -1.48062233e-47 -1.84366661e-47]
 [-3.15600556e-59 -3.92990611e-59 -4.89356539e-59 ... -4.38560444e-48
  -5.46094186e-48 -6.79994888e-48]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00 ...  0.00000000e+00
   0.00000000e+00  0.00000000e+00]]
</pre></div></div>
</div>
<p>At the end of a successful integration step, the floor values and boundaries are enforced.</p>
</section>
<section id="Writer">
<h2>Writer<a class="headerlink" href="#Writer" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">DustPy</span></code> uses by default the <code class="docutils literal notranslate"><span class="pre">hdf5writer</span></code> of <code class="docutils literal notranslate"><span class="pre">simframe</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[72]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">writer</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[72]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Writer (HDF5 file format using h5py)
------------------------------------
    Data directory : data
    File names     : data/data0000.hdf5
    Overwrite      : <span class="ansi-yellow-intense-fg">False</span>
    Dumping        : True
    Options        : {&#39;com&#39;: &#39;lzf&#39;, &#39;comopts&#39;: None}
    Verbosity      : 1
</pre></div></div>
</div>
<p>It is by default writing dump files and prevents overwriting of already existing data files.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="3_advanced_customization.html" class="btn btn-neutral float-left" title="3. Advanced Customization" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="5_dust_coagulation.html" class="btn btn-neutral float-right" title="5. Dust Coagulation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2023, Sebastian Stammler &amp; Tilman Birnstiel.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>